language: php

php:
    - '7.1'
    - '7.2'
    - '7.3'
    - '7.4'

env:
    - DEPENDENCIES=lowest
    - DEPENDENCIES=highest

cache:
    directories:
        - ~/.composer/cache

jobs:
    exclude:
        # symfony/console fails on "YamlStandards\Command\YamlCommandTest::testCorrectRunCommandForFix -> Trying to access array offset on value of type int" and I think it's not necessary fix it, so I skip it
        - php: '7.4'
          env: DEPENDENCIES=lowest

before_script:
    - composer self-update
    - composer global require hirak/prestissimo
    - if [ "${DEPENDENCIES}" = "lowest" ]; then composer update --prefer-lowest --prefer-dist --no-interaction --no-progress; fi;
    - if [ "${DEPENDENCIES}" = "highest" ]; then composer update --prefer-dist --no-interaction --no-progress; fi;

script:
    - vendor/bin/phing build-ci
